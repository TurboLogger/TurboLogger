{
  "metadata": {
    "analysis_date": "2025-11-09",
    "repository": "TurboLogger",
    "total_bugs_found": 55,
    "total_bugs_fixed": 11,
    "analyzer": "Claude Code - Comprehensive Repository Analysis"
  },
  "severity_summary": {
    "CRITICAL": 6,
    "HIGH": 15,
    "MEDIUM": 27,
    "LOW": 7
  },
  "category_summary": {
    "Security": 5,
    "Data Corruption": 4,
    "Resource Leaks": 5,
    "Null/Undefined": 4,
    "Logic Errors": 4,
    "Type Mismatches": 3,
    "API Contracts": 3,
    "State Management": 2,
    "Error Propagation": 3,
    "Async/Await": 4,
    "External Dependencies": 3,
    "Edge Cases": 4,
    "Dead Code": 3,
    "Deprecated": 2,
    "Performance": 4,
    "Missing Dependencies": 2
  },
  "bugs": [
    {
      "id": "BUG-001",
      "severity": "HIGH",
      "category": "Security",
      "file": "src/security/pii-detector.ts",
      "lines": "29-103",
      "title": "Potential ReDoS (Regular Expression Denial of Service)",
      "description": "Multiple regex patterns without complexity limits can cause ReDoS attacks",
      "impact": "An attacker could freeze the logging system by providing malicious input",
      "status": "FIXED",
      "test_added": false
    },
    {
      "id": "BUG-002",
      "severity": "CRITICAL",
      "category": "Security",
      "file": "src/core/transport.ts",
      "lines": "197-239",
      "title": "Insufficient Path Traversal Protection",
      "description": "sanitizePath method has incomplete path traversal protection for Windows UNC paths",
      "impact": "Attackers could write logs to arbitrary file system locations",
      "status": "FIXED",
      "test_added": false
    },
    {
      "id": "BUG-003",
      "severity": "MEDIUM",
      "category": "Security",
      "file": "src/integrations/fastify.ts",
      "lines": "110-112",
      "title": "Weak Randomness for Security-Critical Operations",
      "description": "Uses Math.random() for generating request IDs instead of crypto.randomBytes()",
      "impact": "Request ID collisions or prediction could enable session hijacking",
      "status": "FIXED",
      "test_added": false
    },
    {
      "id": "BUG-004",
      "severity": "HIGH",
      "category": "Security",
      "file": "src/core/security-manager.ts",
      "lines": "234-250",
      "title": "Missing Input Validation in Security Manager",
      "description": "isDangerousKey check misses many dangerous properties like __lookupSetter__, __defineGetter__",
      "impact": "Prototype pollution attacks could succeed through unprotected properties",
      "status": "FIXED",
      "test_added": false
    },
    {
      "id": "BUG-005",
      "severity": "MEDIUM",
      "category": "Security",
      "file": "src/core/security-manager.ts",
      "lines": "119-123",
      "title": "SQL Injection Pattern Detection is Too Broad",
      "description": "SQL injection detection pattern flags legitimate log messages containing SQL keywords",
      "impact": "Loss of important log information, making debugging difficult",
      "status": "PENDING",
      "test_added": false
    },
    {
      "id": "BUG-006",
      "severity": "HIGH",
      "category": "Data Corruption",
      "file": "src/core/buffer.ts",
      "lines": "33-59",
      "title": "Race Condition in CircularBuffer",
      "description": "write() method has race condition between check and operations",
      "impact": "Buffer overflow, data loss, or corrupted log entries in high-concurrency scenarios",
      "status": "FIXED",
      "test_added": false
    },
    {
      "id": "BUG-007",
      "severity": "MEDIUM",
      "category": "Data Corruption",
      "file": "src/core/logger.ts",
      "lines": "451-466",
      "title": "Unsafe State Mutation in Logger Child Creation",
      "description": "child() method creates shallow copies of transports leading to shared mutable state",
      "impact": "Modifications to child logger transports affect parent logger",
      "status": "PENDING",
      "test_added": false
    },
    {
      "id": "BUG-008",
      "severity": "HIGH",
      "category": "Data Corruption",
      "file": "src/core/buffers/pool.ts",
      "lines": "46-63",
      "title": "Missing Synchronization in Memory Pool",
      "description": "acquire() and release() methods are not thread-safe",
      "impact": "Memory corruption, use-after-free errors, or pool exhaustion under concurrent load",
      "status": "FIXED",
      "test_added": false
    },
    {
      "id": "BUG-009",
      "severity": "MEDIUM",
      "category": "Data Corruption",
      "file": "src/analytics/aggregation.ts",
      "lines": "127-139",
      "title": "Concurrent Modification in Aggregation Data",
      "description": "addLog() method modifies aggregationData without synchronization",
      "impact": "Corrupted aggregation data, incorrect metrics, or runtime errors",
      "status": "PENDING",
      "test_added": false
    },
    {
      "id": "BUG-010",
      "severity": "HIGH",
      "category": "Resource Leak",
      "file": "src/core/performance-monitor.ts",
      "lines": "350-375",
      "title": "Event Listener Leak in PerformanceMonitor",
      "description": "startEventLoopMonitoring() creates recursive setTimeout without storing references",
      "impact": "Memory leak through accumulating timeout callbacks, eventually causing OOM",
      "status": "FIXED",
      "test_added": false
    },
    {
      "id": "BUG-011",
      "severity": "CRITICAL",
      "category": "Resource Leak",
      "file": "src/core/transport.ts",
      "lines": "340-343",
      "title": "Missing Stream Cleanup in FileTransport",
      "description": "destroy() method doesn't wait for stream to close or handle 'close' event",
      "impact": "File handle exhaustion, preventing new files from being opened",
      "status": "FIXED",
      "test_added": false
    },
    {
      "id": "BUG-012",
      "severity": "MEDIUM",
      "category": "Resource Leak",
      "file": "src/core/sampling.ts",
      "lines": "254-262",
      "title": "Interval Timer Leak in LogSampler",
      "description": "startAdaptiveAdjustment() creates interval without storing ID for cleanup",
      "impact": "CPU waste and memory leak from orphaned interval callbacks",
      "status": "FIXED",
      "test_added": false
    },
    {
      "id": "BUG-013",
      "severity": "HIGH",
      "category": "Resource Leak",
      "file": "src/observability/metrics.ts",
      "lines": "292-310",
      "title": "HTTP Server Leak in Metrics",
      "description": "startPrometheusServer() creates HTTP server without proper error handling or cleanup",
      "impact": "Port binding failures and resource leaks when server can't start",
      "status": "FIXED",
      "test_added": false
    },
    {
      "id": "BUG-014",
      "severity": "CRITICAL",
      "category": "Resource Leak",
      "file": "src/transports/elasticsearch.ts",
      "lines": "410-420",
      "title": "Unclosed Connections in Elasticsearch Transport",
      "description": "destroy() method doesn't close Elasticsearch client connection",
      "impact": "Connection pool exhaustion, preventing new connections",
      "status": "FIXED",
      "test_added": false
    },
    {
      "id": "BUG-015",
      "severity": "MEDIUM",
      "category": "Null/Undefined",
      "file": "src/core/serializer.ts",
      "lines": "188-196",
      "title": "Unsafe Property Access in Serializer",
      "description": "Cache get could return undefined but not properly checked",
      "impact": "Runtime errors when cache returns undefined",
      "status": "PENDING",
      "test_added": false
    },
    {
      "id": "BUG-016",
      "severity": "MEDIUM",
      "category": "Null/Undefined",
      "file": "src/core/plugin-manager.ts",
      "lines": "116-146",
      "title": "Missing Null Check in Plugin Process",
      "description": "processLog() doesn't validate plugin.process is defined before calling",
      "impact": "TypeError when plugin doesn't implement process method correctly",
      "status": "PENDING",
      "test_added": false
    },
    {
      "id": "BUG-017",
      "severity": "LOW",
      "category": "Null/Undefined",
      "file": "src/core/event-manager.ts",
      "lines": "205-207",
      "title": "Undefined Return in EventManager",
      "description": "originalEnd.apply could return undefined if originalEnd is falsy",
      "impact": "Type inconsistency and potential undefined propagation",
      "status": "PENDING",
      "test_added": false
    },
    {
      "id": "BUG-018",
      "severity": "MEDIUM",
      "category": "Null/Undefined",
      "file": "src/observability/tracing.ts",
      "lines": "305-306",
      "title": "Unsafe Optional Chaining Alternative",
      "description": "Accesses span.parentSpanId without validating span exists",
      "impact": "Runtime errors in trace export",
      "status": "PENDING",
      "test_added": false
    },
    {
      "id": "BUG-019",
      "severity": "MEDIUM",
      "category": "Logic Error",
      "file": "src/core/performance-monitor.ts",
      "lines": "318-329",
      "title": "Off-by-One Error in Percentile Calculation",
      "description": "Percentile calculation can return values outside array bounds when p = 1.0",
      "impact": "Incorrect percentile values in metrics, especially for p99 and p100",
      "status": "PENDING",
      "test_added": false
    },
    {
      "id": "BUG-020",
      "severity": "MEDIUM",
      "category": "Logic Error",
      "file": "src/integrations/express.ts",
      "lines": "353-361",
      "title": "Inverted Logic in shouldSkipPath",
      "description": "path.startsWith() will match partial paths incorrectly",
      "impact": "Incorrect path skipping, logs may be missed or incorrectly filtered",
      "status": "FIXED",
      "test_added": false
    },
    {
      "id": "BUG-021",
      "severity": "MEDIUM",
      "category": "Logic Error",
      "file": "src/core/sampling.ts",
      "lines": "181-197",
      "title": "Incorrect Time Window Calculation in Sampling",
      "description": "Overnight window check has inverted logic using AND instead of OR",
      "impact": "Time-based sampling rules don't work correctly for overnight windows",
      "status": "PENDING",
      "test_added": false
    },
    {
      "id": "BUG-022",
      "severity": "LOW",
      "category": "Logic Error",
      "file": "src/core/buffers/pool.ts",
      "lines": "160-161",
      "title": "Wrong Comparison in Buffer Size Check",
      "description": "Power-of-2 check doesn't account for size=0",
      "impact": "Buffer initialization with size=0 would cause division errors",
      "status": "PENDING",
      "test_added": false
    },
    {
      "id": "BUG-023",
      "severity": "MEDIUM",
      "category": "Type Mismatch",
      "file": "src/core/logger.ts",
      "lines": "265-268",
      "title": "Type Confusion in Log Level Comparison",
      "description": "Compares string level with number level by accident",
      "impact": "Type confusion could lead to incorrect log filtering if level formats change",
      "status": "PENDING",
      "test_added": false
    },
    {
      "id": "BUG-024",
      "severity": "LOW",
      "category": "Type Mismatch",
      "file": "src/transports/cloud/azure-monitor.ts",
      "lines": "461-463",
      "title": "Incorrect Type Cast in Azure Monitor",
      "description": "Math.random().toString(36) returns string but function signature might expect different format",
      "impact": "Type inconsistency in ID generation",
      "status": "PENDING",
      "test_added": false
    },
    {
      "id": "BUG-025",
      "severity": "MEDIUM",
      "category": "Type Mismatch",
      "file": "src/ml/log-classifier.ts",
      "lines": "331-344",
      "title": "Missing Type Validation in Feature Extractors",
      "description": "extractFeatures() assumes all extractors return correct type without validation",
      "impact": "Type inconsistencies in ML features leading to classification errors",
      "status": "PENDING",
      "test_added": false
    },
    {
      "id": "BUG-026",
      "severity": "MEDIUM",
      "category": "API Contract",
      "file": "src/core/logger.ts",
      "lines": "468-486",
      "title": "Inconsistent Return Types in Logger Methods",
      "description": "withContext() returns different types based on whether fn is provided",
      "impact": "Type confusion for consumers, TypeScript compilation errors",
      "status": "PENDING",
      "test_added": false
    },
    {
      "id": "BUG-027",
      "severity": "HIGH",
      "category": "API Contract",
      "file": "src/core/transport.ts",
      "lines": "245-251",
      "title": "Missing Error Propagation in Transport Write",
      "description": "write() method can fail silently without propagating errors",
      "impact": "Lost logs without notification, violating error handling contracts",
      "status": "FIXED",
      "test_added": false
    },
    {
      "id": "BUG-028",
      "severity": "MEDIUM",
      "category": "API Contract",
      "file": "src/core/di/container.ts",
      "lines": "169-184",
      "title": "Incorrect Parameter Usage in DI Container",
      "description": "createInstance() doesn't validate that dependencies array matches factory parameters",
      "impact": "Runtime errors when factory receives wrong number or types of dependencies",
      "status": "PENDING",
      "test_added": false
    },
    {
      "id": "BUG-029",
      "severity": "MEDIUM",
      "category": "State Management",
      "file": "src/core/buffer.ts",
      "lines": "144-149",
      "title": "Inconsistent State in Circular Buffer",
      "description": "clear() method doesn't handle pending flush operations",
      "impact": "Buffer can flush cleared data or enter invalid state",
      "status": "PENDING",
      "test_added": false
    },
    {
      "id": "BUG-030",
      "severity": "MEDIUM",
      "category": "State Management",
      "file": "src/core/plugin-manager.ts",
      "lines": "215-238",
      "title": "Missing State Reset in Plugin Manager",
      "description": "Destroyed instances cannot be reinitialized",
      "impact": "Plugin manager cannot be reinitialized after destruction",
      "status": "PENDING",
      "test_added": false
    },
    {
      "id": "BUG-031",
      "severity": "HIGH",
      "category": "Error Propagation",
      "file": "src/core/logger/logger-core.ts",
      "lines": "312-348",
      "title": "Swallowed Exceptions in Log Processing",
      "description": "processLogEntry() catches all errors and never rethrows or indicates failure",
      "impact": "Critical logging failures go unnoticed, making debugging impossible",
      "status": "FIXED",
      "test_added": false
    },
    {
      "id": "BUG-032",
      "severity": "MEDIUM",
      "category": "Error Propagation",
      "file": "src/core/optimized-serializer.ts",
      "lines": "62-112",
      "title": "Missing Error Boundaries in Serializer",
      "description": "Fallback to JSON.stringify() can also throw for circular references or BigInt",
      "impact": "Serialization failures can crash the logging system",
      "status": "PENDING",
      "test_added": false
    },
    {
      "id": "BUG-033",
      "severity": "MEDIUM",
      "category": "Error Propagation",
      "file": "src/transports/cloud/cloudwatch.ts",
      "lines": "361-385",
      "title": "Incorrect Error Type in CloudWatch",
      "description": "flushBatch() re-queues events for all errors, even non-transient ones",
      "impact": "Infinite retry loops for permanent failures, memory exhaustion",
      "status": "PENDING",
      "test_added": false
    },
    {
      "id": "BUG-034",
      "severity": "CRITICAL",
      "category": "Async/Await",
      "file": "src/core/logger.ts",
      "lines": "382-384",
      "title": "Missing Await in Buffer Flush",
      "description": "Fatal logs call flush() without await, may not write before process exit",
      "impact": "Lost fatal logs when process terminates immediately after logging",
      "status": "FIXED",
      "test_added": false
    },
    {
      "id": "BUG-035",
      "severity": "HIGH",
      "category": "Async/Await",
      "file": "src/transports/elasticsearch.ts",
      "lines": "101-146",
      "title": "Race Condition in Transport Initialization",
      "description": "initializeClient() is async but called from constructor without await",
      "impact": "Writes fail because client isn't ready, data loss",
      "status": "FIXED",
      "test_added": false
    },
    {
      "id": "BUG-036",
      "severity": "MEDIUM",
      "category": "Async/Await",
      "file": "src/observability/tracing.ts",
      "lines": "269-299",
      "title": "Unhandled Promise Rejection in Tracing",
      "description": "sendToJaeger() fetch promise could reject in ways not caught",
      "impact": "Unhandled promise rejections crash Node.js process",
      "status": "PENDING",
      "test_added": false
    },
    {
      "id": "BUG-037",
      "severity": "MEDIUM",
      "category": "Async/Await",
      "file": "src/core/plugin-manager.ts",
      "lines": "186-213",
      "title": "Missing Await in Plugin Initialization Chain",
      "description": "initializeAllPlugins() uses Promise.all() without proper error aggregation",
      "impact": "Plugin initialization failures not properly reported",
      "status": "PENDING",
      "test_added": false
    },
    {
      "id": "BUG-038",
      "severity": "MEDIUM",
      "category": "External Dependencies",
      "file": "src/transports/elasticsearch.ts",
      "lines": "101-146",
      "title": "Missing Error Handling for require() calls",
      "description": "require('@elastic/elasticsearch') without try-catch crashes if package not installed",
      "impact": "Crash when optional dependency is missing",
      "status": "PENDING",
      "test_added": false
    },
    {
      "id": "BUG-039",
      "severity": "HIGH",
      "category": "External Dependencies",
      "file": "src/transports/cloud/stackdriver.ts",
      "lines": "191-256",
      "title": "No Timeout for Network Requests",
      "description": "makeStackdriverRequest() creates HTTPS requests without timeout",
      "impact": "Logging system hangs on network issues",
      "status": "FIXED",
      "test_added": false
    },
    {
      "id": "BUG-040",
      "severity": "MEDIUM",
      "category": "External Dependencies",
      "file": "src/transports/cloud/cloudwatch.ts",
      "lines": "387-436",
      "title": "Missing Validation of Cloud SDK Responses",
      "description": "sendBatchToCloudWatch() assumes AWS API responses have expected structure",
      "impact": "Type errors when AWS API response format changes",
      "status": "PENDING",
      "test_added": false
    },
    {
      "id": "BUG-041",
      "severity": "MEDIUM",
      "category": "Edge Cases",
      "file": "src/analytics/aggregation.ts",
      "lines": "396-404",
      "title": "Empty Array Handling in Percentile",
      "description": "percentile() doesn't validate sortedValues is non-empty before accessing",
      "impact": "Runtime error when calculating percentiles on empty datasets",
      "status": "PENDING",
      "test_added": false
    },
    {
      "id": "BUG-042",
      "severity": "LOW",
      "category": "Edge Cases",
      "file": "src/core/performance.ts",
      "lines": "88-89",
      "title": "Division by Zero in CPU Calculation",
      "description": "CPU calculation can result in Infinity if elapsedMs is 0",
      "impact": "Invalid CPU metrics, NaN propagation",
      "status": "PENDING",
      "test_added": false
    },
    {
      "id": "BUG-043",
      "severity": "MEDIUM",
      "category": "Edge Cases",
      "file": "src/core/buffers/pool.ts",
      "lines": "185-214",
      "title": "Boundary Condition in Buffer Write",
      "description": "Bitwise operations for size=1 edge case could cause logical errors",
      "impact": "Potential logical errors for edge case buffer sizes",
      "status": "PENDING",
      "test_added": false
    },
    {
      "id": "BUG-044",
      "severity": "LOW",
      "category": "Edge Cases",
      "file": "src/security/pii-detector.ts",
      "lines": "168-201",
      "title": "Missing Validation for Zero-Length Strings",
      "description": "maskString() doesn't check if text is empty before processing",
      "impact": "Performance waste on empty strings",
      "status": "PENDING",
      "test_added": false
    },
    {
      "id": "BUG-045",
      "severity": "LOW",
      "category": "Dead Code",
      "file": "src/core/performance.ts",
      "lines": "86",
      "title": "Unused Variable in Performance Monitor",
      "description": "Commented-out code that's never used",
      "impact": "Code clutter, confusion",
      "status": "PENDING",
      "test_added": false
    },
    {
      "id": "BUG-046",
      "severity": "LOW",
      "category": "Dead Code",
      "file": "src/core/errors/index.ts",
      "lines": "293-327",
      "title": "Unreachable Code in Error Handler",
      "description": "Recovery strategies have console.log implementations that don't actually recover",
      "impact": "Recovery strategies don't actually recover",
      "status": "PENDING",
      "test_added": false
    },
    {
      "id": "BUG-047",
      "severity": "LOW",
      "category": "Dead Code",
      "file": "src/observability/metrics.ts",
      "lines": "3",
      "title": "Unused Imports",
      "description": "Imports createHash from crypto but never uses it",
      "impact": "Unnecessary dependency load",
      "status": "PENDING",
      "test_added": false
    },
    {
      "id": "BUG-048",
      "severity": "LOW",
      "category": "Deprecated",
      "file": "src/observability/tracing.ts",
      "lines": "72",
      "title": "Deprecated substr() Method",
      "description": "Uses deprecated substr() method instead of substring() or slice()",
      "impact": "Future compatibility issues",
      "status": "FIXED",
      "test_added": false
    },
    {
      "id": "BUG-049",
      "severity": "MEDIUM",
      "category": "Deprecated",
      "file": "src/core/serializer.ts",
      "lines": "Multiple",
      "title": "Deprecated Buffer Constructor",
      "description": "Buffer.from() usage without encoding specification",
      "impact": "Security risks if Buffer API changes",
      "status": "PENDING",
      "test_added": false
    },
    {
      "id": "BUG-050",
      "severity": "MEDIUM",
      "category": "Performance",
      "file": "src/core/plugin-manager.ts",
      "lines": "116-146",
      "title": "N+1 Query Pattern in Plugin Processing",
      "description": "processLog() iterates through plugins sequentially with await",
      "impact": "Slow log processing with many plugins",
      "status": "PENDING",
      "test_added": false
    },
    {
      "id": "BUG-051",
      "severity": "LOW",
      "category": "Performance",
      "file": "src/core/transport.ts",
      "lines": "106-129",
      "title": "Inefficient String Concatenation in Formatting",
      "description": "formatPretty() uses multiple string concatenations",
      "impact": "Poor performance with high log volume",
      "status": "PENDING",
      "test_added": false
    },
    {
      "id": "BUG-052",
      "severity": "MEDIUM",
      "category": "Performance",
      "file": "src/observability/metrics.ts",
      "lines": "152-177",
      "title": "Unnecessary Iteration in Metrics Export",
      "description": "exportPrometheus() has O(n\u00b2) complexity",
      "impact": "Slow metrics export with large datasets",
      "status": "PENDING",
      "test_added": false
    },
    {
      "id": "BUG-053",
      "severity": "MEDIUM",
      "category": "Performance",
      "file": "src/ml/log-classifier.ts",
      "lines": "260-275",
      "title": "RegEx Recompilation in Pattern Matching",
      "description": "Creates new RegExp for each analysis, recompiling same regex repeatedly",
      "impact": "CPU waste, slow pattern matching",
      "status": "PENDING",
      "test_added": false
    },
    {
      "id": "BUG-054",
      "severity": "HIGH",
      "category": "Missing Dependencies",
      "file": "Multiple transport files",
      "lines": "N/A",
      "title": "Optional Dependencies Not Declared",
      "description": "Cloud SDKs required but not in package.json as optionalDependencies",
      "impact": "Runtime errors when users try to use cloud transports without installing dependencies",
      "status": "FIXED",
      "test_added": false
    },
    {
      "id": "BUG-055",
      "severity": "MEDIUM",
      "category": "Missing Dependencies",
      "file": "src/core/config/schema.ts",
      "lines": "1",
      "title": "Missing zod Dependency Handling",
      "description": "Imports zod without error handling, crashes if not installed",
      "impact": "Hard dependency on zod even if validation isn't needed",
      "status": "PENDING",
      "test_added": false
    },
    {
      "id": "BUG-056",
      "severity": "HIGH",
      "category": "Missing Dependencies",
      "file": "scripts/test-runner.js",
      "lines": "11",
      "title": "Missing glob Dependency",
      "description": "test-runner.js requires 'glob' module but it's not in package.json",
      "impact": "Cannot run tests without manually installing glob",
      "status": "FIXED",
      "test_added": false
    }
  ]
}